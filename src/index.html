<!doctype html>
<html ng-app="schedully">
  <head>
    <meta charset="utf-8">
    <title>schedully</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

    <!-- build:css({.tmp/serve,src}) styles/vendor.css -->
    <!-- bower:css -->
    <!-- run `gulp inject` to automatically populate bower styles dependencies -->
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:css({.tmp/serve,src}) styles/app.css -->
    <!-- inject:css -->
    <!-- css files will be automatically insert here -->
    <!-- endinject -->
    <!-- endbuild -->
  </head>
  <body style="padding: 15px">
    <div ng-controller="MainController as main" style="max-width: 600px;">
      <div layout="column" layout-align="center">
        <div id="options">
          <md-checkbox ng-model="main.$storage.useGeoLocation" ng-change="main.refreshSchedule()">
            Геолокация
          </md-checkbox>
          <div id="selects">
            <md-select ng-model="main.locationIdFrom"
                       ng-change="main.refreshSchedule()"
                       ng-disabled="main.$storage.useGeoLocation">
              <md-option ng-value="location.id" ng-repeat="location in main.appDB.locations">
                {{location.name}}
              </md-option>
            </md-select>
            <md-select ng-model="main.locationIdTo"
                       ng-change="main.refreshSchedule()"
                       ng-disabled="main.availableSchedules.length <= 1">
              <md-option ng-value="schedule.to" ng-repeat="schedule in main.availableSchedules">
                {{main.locationsById[schedule.to].name}}
              </md-option>
            </md-select>
          </div>

          <div flex>
            <div layout="row">
              <div flex>
                <small flex class="md-caption gray">{{main.locationsById[main.locationIdFrom].places[0].name}}</small>
                <div class="md-display-2" >{{main.timeToClosest | date:"mm:ss"}}</div>
              </div>

              <div align="right" flex layout="column">
                <table ng-class="{'gray': !main.$storage.useGeoLocation}" class="md-caption">
                  <tr>
                    <td>Дистанция:</td><td>{{main.distance || "n/a"}} м</td>
                  </tr>
                  <tr>
                    <td>ETA:</td><td>{{(main.approximateArivalTime  | date:"mm:ss") || "n/a"}}</td>
                  </tr>
                  <tr>
                    <td>Скорость:</td><td>{{main.currentPosition.coords.speed || "n/a"}} м/с</td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div layout="row">
              <div flex="33">Время</div>
              <div flex="33">Следующий</div>
              <div >Осталось</div>
          </div>
        </div>
        <md-content layout-padding md-scroll-y flex>
          <div ng-repeat="time in main.closestTimes" layout="row">
            <div flex="33">{{time.at | date:"HH:mm"}}</div>
            <div flex="33">{{time.nextAfterMinutes}}</div>
            <div am-time-ago="time.at"></div>
          </div>
        </md-content>
      </div>
    </div>

    <!-- build:js(src) scripts/vendor.js -->
    <!-- bower:js -->
    <!-- run `gulp inject` to automatically populate bower script dependencies -->
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:js({.tmp/serve,.tmp/partials,src}) scripts/app.js -->
    <!-- inject:js -->
    <!-- js files will be automatically insert here -->
    <!-- endinject -->

    <!-- inject:partials -->
    <!-- angular templates will be automatically converted in js and inserted here -->
    <!-- endinject -->
    <!-- endbuild -->

  </body>
</html>
